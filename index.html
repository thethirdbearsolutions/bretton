<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bretton Woods Conference - Multiplayer (Server)</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="root">
        <div class="container">
            <div class="card">
                <p style="text-align: center; padding: 40px;">Connecting to server...</p>
            </div>
        </div>
    </div>
    
    <!-- Socket.io client -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel">
        // Load game data
        let gameData = null;
        fetch('/game-data.json')
          .then(r => r.json())
          .then(data => {
            gameData = data;
            initializeApp();
          });

        const socket = io();
        const { useState, useEffect } = React;

        const BrettonWoodsMultiplayer = () => {
          const [playerId] = useState(() => {
            let id = sessionStorage.getItem('brettonWoodsPlayerId');
            if (!id) {
              id = `player_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
              sessionStorage.setItem('brettonWoodsPlayerId', id);
            }
            return id;
          });
          
          const [playerCountry, setPlayerCountry] = useState(null);
          const [isReady, setIsReady] = useState(false);
          const [gameStateData, setGameStateData] = useState(null);
          const [showEconomics, setShowEconomics] = useState(false);
          const [connected, setConnected] = useState(false);
          
          // Authentication state
          const [isAuthenticated, setIsAuthenticated] = useState(false);
          const [username, setUsername] = useState('');
          const [showRegister, setShowRegister] = useState(false);
          const [isCheckingResume, setIsCheckingResume] = useState(false);

          // Check for existing session on mount
          useEffect(() => {
            const savedUsername = sessionStorage.getItem('brettonWoodsUsername');
            const savedPlayerId = sessionStorage.getItem('brettonWoodsPlayerId');
            
            if (savedUsername && savedPlayerId) {
              setUsername(savedUsername);
              setIsAuthenticated(true);
              setIsCheckingResume(true); // Start checking for resume
              
              // Set up resume check listener
              const handleResumeCheck = (result) => {
                setIsCheckingResume(false); // Resume check complete
                
                if (result.shouldResume && result.country) {
                  console.log('Auto-resuming as', result.country);
                  setPlayerCountry(result.country);
                  
                  // Show notification
                  const phase = result.gamePhase === 'phase2' 
                    ? `Year ${result.currentYear}`
                    : result.gamePhase === 'voting'
                    ? `Round ${result.currentRound}`
                    : result.gamePhase;
                  
                  setTimeout(() => {
                    alert(`Session restored! Resuming as ${result.country} (${phase})`);
                  }, 500);
                }
              };
              
              socket.on('resumeCheck', handleResumeCheck);
              
              // Check for resume after connection
              const checkForResume = () => {
                if (socket.connected) {
                  socket.emit('checkResume', { playerId: savedPlayerId });
                }
              };
              
              // Check immediately if already connected
              if (socket.connected) {
                checkForResume();
              }
              
              // Also check on connection
              socket.on('connect', checkForResume);
              
              return () => {
                socket.off('resumeCheck', handleResumeCheck);
                socket.off('connect', checkForResume);
              };
            } else {
              setIsCheckingResume(false); // No session to check
            }
          }, []);


          useEffect(() => {
            // Socket event listeners
            socket.on('connect', () => {
              console.log('Connected to server');
              setConnected(true);
            });

            socket.on('disconnect', () => {
              console.log('Disconnected from server');
              setConnected(false);
            });

            socket.on('stateUpdate', (state) => {
              setGameStateData(state);
              const player = state.players[playerId];
              if (player) {
                setPlayerCountry(player.country);
              }
              setIsReady(state.readyPlayers.includes(playerId));
            });

            socket.on('joinResult', (result) => {
              if (!result.success) {
                alert(result.message);
              }
            });

            

            // Authentication result handlers
            socket.on('registerResult', (result) => {
              if (result.success) {
                sessionStorage.setItem('brettonWoodsPlayerId', result.playerId);
                sessionStorage.setItem('brettonWoodsUsername', result.username);
                setUsername(result.username);
                setIsAuthenticated(true);
              } else {
                alert(result.message);
              }
            });

            socket.on('loginResult', (result) => {
              if (result.success) {
                sessionStorage.setItem('brettonWoodsPlayerId', result.playerId);
                sessionStorage.setItem('brettonWoodsUsername', result.username);
                setUsername(result.username);
                setIsAuthenticated(true);
                
                // Auto-resume if player was in game
                if (result.resumeData && result.resumeData.country) {
                  console.log('Resuming as', result.resumeData.country);
                  setPlayerCountry(result.resumeData.country);
                  setIsCheckingResume(false);
                  
                  // Show resume notification
                  const phase = result.resumeData.gamePhase === 'phase2' 
                    ? `Phase 2 Year ${result.resumeData.currentYear}`
                    : result.resumeData.gamePhase === 'voting'
                    ? `Phase 1 Round ${result.resumeData.currentRound}`
                    : result.resumeData.gamePhase;
                  
                  alert(`Welcome back! Resuming as ${result.resumeData.country} (${phase})`);
                } else {
                  setIsCheckingResume(false);
                }
              } else {
                setIsCheckingResume(false);
                
                // Provide helpful error message
                let errorMsg = result.message;
                if (result.message === 'Invalid username or password') {
                  errorMsg += '\n\nTip: If you recently registered but the server restarted, you may need to register again or click "Clear Saved Session" to start fresh.';
                }
                alert(errorMsg);
              }
            });

            return () => {
              socket.off('connect');
              socket.off('disconnect');
              socket.off('stateUpdate');
              socket.off('joinResult');
              socket.off('registerResult');
              socket.off('loginResult');
            };
          }, [playerId]);

          const joinGame = (country) => {
            socket.emit('joinGame', { playerId, country });
          };

          const leaveGame = () => {
            socket.emit('leaveGame', { playerId });
            setPlayerCountry(null);
          };

          const toggleReady = () => {
            const newReady = !isReady;
            socket.emit('setReady', { playerId, ready: newReady });
          };

          const startGame = () => {
            socket.emit('startGame');
          };

          const submitVote = (issueId, optionId) => {
            socket.emit('submitVote', { playerId, issueId, optionId });
          };

          const advanceRound = () => {
            socket.emit('nextRound');
          };

          const resetGame = () => {
            if (confirm('Are you sure you want to reset the game for all players?')) {
              socket.emit('resetGame');
              setPlayerCountry(null);
            }
          };
          
          const handleAuth = (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const user = formData.get('username');
            const pass = formData.get('password');
            
            if (showRegister) {
              socket.emit('register', { username: user, password: pass });
            } else {
              socket.emit('login', { username: user, password: pass });
            }
          };

          const handleLogout = () => {
            sessionStorage.clear();
            setIsAuthenticated(false);
            setUsername('');
            setPlayerCountry(null);
            window.location.reload();
          };


          
          
          // Username display component
          const UserDisplay = () => (
            <div style={{
              position: 'fixed',
              top: '10px',
              left: '10px',
              padding: '8px 16px',
              background: '#eff6ff',
              color: '#1e40af',
              borderRadius: '6px',
              fontSize: '0.875rem',
              fontWeight: '600',
              zIndex: 1000,
              boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
            }}>
              üë§ {username}
              <button
                onClick={handleLogout}
                style={{
                  marginLeft: '12px',
                  padding: '4px 8px',
                  background: '#dc2626',
                  color: 'white',
                  border: 'none',
                  borderRadius: '4px',
                  cursor: 'pointer',
                  fontSize: '0.75rem'
                }}
              >
                Logout
              </button>
            </div>
          );

          
          
          // Show login screen if not authenticated
          if (!isAuthenticated) {
            return (
              <div className="container">
                <div className="header">
                  <h1>üåç Bretton Woods Conference</h1>
                  <p>Educational Multiplayer Simulation</p>
                </div>
                
                <div className="card" style={{ maxWidth: '400px', margin: '0 auto' }}>
                  <h2 style={{ textAlign: 'center', marginBottom: '30px' }}>
                    {showRegister ? 'Create Account' : 'Login'}
                  </h2>
                  
                  <form onSubmit={handleAuth}>
                    <div style={{ marginBottom: '20px' }}>
                      <label style={{ display: 'block', marginBottom: '8px', fontWeight: 'bold' }}>
                        Username
                      </label>
                      <input
                        type="text"
                        name="username"
                        required
                        minLength="3"
                        style={{
                          width: '100%',
                          padding: '12px',
                          fontSize: '1rem',
                          border: '2px solid #cbd5e1',
                          borderRadius: '6px',
                          boxSizing: 'border-box'
                        }}
                        placeholder="Enter username (min 3 characters)"
                      />
                    </div>
                    
                    <div style={{ marginBottom: '30px' }}>
                      <label style={{ display: 'block', marginBottom: '8px', fontWeight: 'bold' }}>
                        Password
                      </label>
                      <input
                        type="password"
                        name="password"
                        required
                        minLength="4"
                        style={{
                          width: '100%',
                          padding: '12px',
                          fontSize: '1rem',
                          border: '2px solid #cbd5e1',
                          borderRadius: '6px',
                          boxSizing: 'border-box'
                        }}
                        placeholder="Enter password (min 4 characters)"
                      />
                    </div>
                    
                    <button
                      type="submit"
                      className="btn-primary"
                      style={{ width: '100%', padding: '14px', fontSize: '1.125rem', marginBottom: '16px' }}
                    >
                      {showRegister ? 'üìù Create Account' : 'üîì Login'}
                    </button>
                  </form>
                  
                  <div style={{ textAlign: 'center', paddingTop: '20px', borderTop: '1px solid #e2e8f0' }}>
                    <button
                      onClick={() => setShowRegister(!showRegister)}
                      style={{
                        background: 'none',
                        border: 'none',
                        color: '#3b82f6',
                        cursor: 'pointer',
                        fontSize: '0.9rem',
                        textDecoration: 'underline'
                      }}
                    >
                      {showRegister 
                        ? 'Already have an account? Login' 
                        : "Don\'t have an account? Register"}
                    </button>
                  </div>
                  
                  <div style={{ 
                    marginTop: '30px', 
                    padding: '16px', 
                    background: '#f8fafc', 
                    borderRadius: '6px',
                    fontSize: '0.875rem',
                    color: '#64748b'
                  }}>
                    <p style={{ marginBottom: '8px' }}><strong>Note:</strong></p>
                    <ul style={{ marginLeft: '20px' }}>
                      <li>Usernames must be at least 3 characters</li>
                      <li>Passwords must be at least 4 characters</li>
                      <li>Your account persists across games</li>
                    </ul>
                  </div>
                  
                  {/* Clear Session Button */}
                  <div style={{ marginTop: '20px', textAlign: 'center' }}>
                    <button
                      onClick={() => {
                        if (confirm('Clear saved session data? You will need to login again.')) {
                          sessionStorage.clear();
                          localStorage.clear();
                          window.location.reload();
                        }
                      }}
                      style={{
                        padding: '8px 16px',
                        background: '#fef3c7',
                        border: '1px solid #f59e0b',
                        borderRadius: '6px',
                        cursor: 'pointer',
                        fontSize: '0.875rem',
                        color: '#92400e'
                      }}
                    >
                      üóëÔ∏è Clear Saved Session
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          if (!gameData || !gameStateData) {
            return (
              <div className="container">
                <div className="card">
                  <p style={{ textAlign: 'center', padding: '40px' }}>
                    {!connected ? 'üî¥ Connecting to server...' : '‚öôÔ∏è Loading game data...'}
                  </p>
                </div>
              </div>
            );
          }

          const { countries, economicData, issues } = gameData;
          
          // Safety check: ensure countries object exists
          if (!countries || typeof countries !== 'object') {
            return (
              <div className="container">
                <div className="card">
                  <p style={{ textAlign: 'center', padding: '40px', color: '#dc2626' }}>
                    ‚ö†Ô∏è Error: Game data is corrupted. Please refresh the page.
                  </p>
                </div>
              </div>
            );
          }
          
          const currentIssue = issues[gameStateData.currentRound - 1];
          const availableCountries = Object.keys(countries).filter(
            country => !Object.values(gameStateData.players).some(p => p.country === country)
          );

          // Connection status indicator
          const ConnectionStatus = () => (
            <div style={{
              position: 'fixed',
              top: '10px',
              right: '10px',
              padding: '8px 16px',
              background: connected ? '#dcfce7' : '#fee2e2',
              color: connected ? '#166534' : '#991b1b',
              borderRadius: '6px',
              fontSize: '0.875rem',
              fontWeight: '600',
              zIndex: 1000
            }}>
              {connected ? 'üü¢ Connected' : 'üî¥ Disconnected'}
            </div>
          );

          // Lobby Screen
          if (!gameStateData.gameStarted && gameStateData.gamePhase === 'lobby') {
            return (
              <div className="container">
                <UserDisplay />
                <ConnectionStatus />
                <div className="header">
                  <h1>üåç Bretton Woods 1944</h1>
                  <p>Multiplayer Simulation - Lobby</p>
                </div>

                <div className="card">
                  <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '20px' }}>
                    <h2 style={{ fontSize: '1.5rem', color: '#1e293b' }}>Game Lobby</h2>
                    <div style={{ fontSize: '0.875rem', color: '#64748b' }}>
                      Room: {gameStateData.gameId}
                    </div>
                  </div>

                  <div style={{ marginBottom: '30px' }}>
                    <h3 style={{ fontSize: '1.125rem', marginBottom: '16px' }}>
                      üë• Players ({Object.keys(gameStateData.players).length}/{Object.keys(countries).length})
                    </h3>
                    
                    <div style={{ display: 'grid', gap: '12px' }}>
                      {Object.entries(gameStateData.players).map(([id, player]) => (
                        <div key={id} style={{
                          display: 'flex',
                          justifyContent: 'space-between',
                          padding: '12px',
                          background: id === playerId ? '#eff6ff' : player.disconnected ? '#fef3c7' : '#f8fafc',
                          borderRadius: '8px',
                          borderLeft: '4px solid ' + (id === playerId ? '#3b82f6' : player.disconnected ? '#f59e0b' : '#cbd5e1'),
                          opacity: player.disconnected ? 0.7 : 1
                        }}>
                          <div>
                            <span className={countries[player.country]?.textColor || 'text-blue-600'} style={{ fontWeight: 'bold' }}>
                              {countries[player.country]?.name || player.country || 'Unknown'}
                            </span>
                            {id === playerId && <span style={{ marginLeft: '8px', fontSize: '0.875rem', color: '#3b82f6' }}>(You)</span>}
                            {player.disconnected && <span style={{ marginLeft: '8px', fontSize: '0.75rem', color: '#d97706' }}>üîå Disconnected</span>}
                          </div>
                          <div>
                            {gameStateData.readyPlayers.includes(id) ? (
                              <span style={{ color: '#16a34a', fontWeight: 'bold' }}>‚úì Ready</span>
                            ) : (
                              <span style={{ color: '#64748b' }}>Not Ready</span>
                            )}
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>

                  {!playerCountry ? (
                    <div>
                      <h3 style={{ fontSize: '1.125rem', marginBottom: '16px' }}>Select Your Nation</h3>
                      <div className="country-grid">
                        {availableCountries.map(key => {
                          const country = countries[key];
                          if (!country) return null;
                          return (
                            <div key={key} className={`country-card ${country.color}`} onClick={() => joinGame(key)}>
                              <h3>{country.name}</h3>
                              <p style={{ fontSize: '0.875rem', marginBottom: '12px', opacity: '0.9' }}>
                                {country.economicPosition}
                              </p>
                              <ul>
                                {country.objectives.slice(0, 2).map((obj, idx) => (
                                  <li key={idx}>{obj}</li>
                                ))}
                              </ul>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  ) : (
                    <div style={{ textAlign: 'center' }}>
                      <div style={{ marginBottom: '20px', padding: '20px', background: '#f8fafc', borderRadius: '8px' }}>
                        <p style={{ color: '#64748b', marginBottom: '8px' }}>You are playing as</p>
                        <h2 className={countries[playerCountry]?.textColor || 'text-blue-600'} style={{ fontSize: '1.75rem' }}>
                          {countries[playerCountry]?.name || playerCountry || 'Unknown'}
                        </h2>
                      </div>
                      
                      <div style={{ display: 'flex', gap: '12px', justifyContent: 'center', flexWrap: 'wrap' }}>
                        <button className={isReady ? 'btn-success' : 'btn-primary'} onClick={toggleReady}>
                          {isReady ? '‚úì Ready' : 'Mark Ready'}
                        </button>
                        <button className="btn-secondary" onClick={leaveGame}>‚Üê Leave Game</button>
                        {Object.keys(gameStateData.players).length > 1 && 
                         gameStateData.readyPlayers.length === Object.keys(gameStateData.players).length && (
                          <button className="btn-success" onClick={startGame}>üéÆ Start Conference</button>
                        )}
                      </div>

                      <button className="btn-danger" onClick={resetGame} style={{ marginTop: '20px' }}>
                        üîÑ Reset Game
                      </button>
                    </div>
                  )}
                </div>
              </div>
            );
          }

          // Phase 2: Economic Management
          if (gameStateData.gamePhase === 'phase2' && gameStateData.phase2 && gameStateData.phase2.active) {
            const currentYear = gameStateData.phase2.currentYear;
            const yearlyData = gameStateData.phase2.yearlyData[currentYear];
            const myCountryData = yearlyData ? yearlyData[playerCountry] : null;
            const myPolicies = gameStateData.phase2.policies[currentYear] ? gameStateData.phase2.policies[currentYear][playerCountry] : null;
            const allSubmitted = Object.keys(gameStateData.players).every(pid => {
              const player = gameStateData.players[pid];
              return gameStateData.phase2.policies[currentYear] && gameStateData.phase2.policies[currentYear][player.country];
            });

            const submitPolicies = (e) => {
              e.preventDefault();
              const formData = new FormData(e.target);
              const centralBankRate = formData.get('centralBankRate');
              const exchangeRate = formData.get('exchangeRate');
              const tariffRate = formData.get('tariffRate');
              
              socket.emit('setPhase2Policies', {
                playerId,
                centralBankRate: parseFloat(centralBankRate),
                exchangeRate: parseFloat(exchangeRate),
                tariffRate: parseFloat(tariffRate)
              });
            };

            const advanceYear = () => {
              socket.emit('advanceYear');
            };

            // China Civil War detection
            const isChinaCivilWar = playerCountry === 'China' && currentYear >= 1946 && currentYear <= 1949;
            const isChinaCommunist = playerCountry === 'China' && currentYear >= 1950;
            
            // India Independence transition detection
            const isIndiaColonial = playerCountry === 'India' && currentYear >= 1946 && currentYear <= 1946;
            const isIndiaPartition = playerCountry === 'India' && currentYear === 1947;
            const isIndiaPostPartition = playerCountry === 'India' && currentYear === 1948;
            const isIndiaIndependent = playerCountry === 'India' && currentYear >= 1949;

            return (
              <div className="container">
                <UserDisplay />
                <ConnectionStatus />
                <div className="header">
                  <h1>üìä Post-War Economic Management</h1>
                  <p>Phase 2: Year {currentYear} of 1946-1952</p>
                </div>

                <div className="card">
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '30px' }}>
                    <div>
                      <h2 style={{ fontSize: '1.5rem', color: '#1e293b', marginBottom: '8px' }}>
                        Year {currentYear} ({currentYear - 1945} of 7)
                      </h2>
                      <p style={{ color: '#64748b', fontSize: '0.9rem' }}>
                        Playing as: <span style={{ fontWeight: 'bold', color: '#3b82f6' }}>
                          {playerCountry === 'India' && currentYear < 1947 
                            ? 'India (British Raj)' 
                            : playerCountry === 'India' && currentYear === 1947
                            ? 'India (Partition Year)'
                            : playerCountry === 'India' && currentYear >= 1948
                            ? 'Republic of India'
                            : countries[playerCountry]?.name || playerCountry || 'Unknown'}
                        </span>
                      </p>
                    </div>
                    <div style={{ textAlign: 'right' }}>
                      <div style={{ fontSize: '0.875rem', color: '#64748b' }}>Phase 1 Score</div>
                      <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#16a34a' }}>
                        {gameStateData.scores[playerCountry]} pts
                      </div>
                    </div>
                  </div>

                  {/* China Civil War Banner */}
                  {isChinaCivilWar && (
                    <div style={{
                      padding: '20px',
                      background: '#fef2f2',
                      border: '2px solid #dc2626',
                      borderRadius: '8px',
                      marginBottom: '30px'
                    }}>
                      <div style={{ 
                        fontWeight: 'bold', 
                        color: '#dc2626', 
                        fontSize: '1.125rem',
                        marginBottom: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}>
                        ‚ö†Ô∏è CHINESE CIVIL WAR ({currentYear})
                      </div>
                      <div style={{ fontSize: '0.9rem', color: '#7f1d1d', marginBottom: '8px' }}>
                        The Nationalist government faces Communist insurgency. Your economy suffers severe disruption.
                      </div>
                      <div style={{ 
                        display: 'grid', 
                        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                        gap: '8px',
                        marginTop: '12px',
                        padding: '12px',
                        background: '#fee2e2',
                        borderRadius: '6px'
                      }}>
                        <div style={{ fontSize: '0.875rem', color: '#991b1b' }}>
                          <strong>GDP:</strong> -2% penalty
                        </div>
                        <div style={{ fontSize: '0.875rem', color: '#991b1b' }}>
                          <strong>Inflation:</strong> +10% (hyperinflation)
                        </div>
                        <div style={{ fontSize: '0.875rem', color: '#991b1b' }}>
                          <strong>Trade:</strong> -$500M disruption
                        </div>
                      </div>
                      <div style={{ 
                        marginTop: '12px', 
                        fontSize: '0.875rem', 
                        color: '#7f1d1d',
                        fontStyle: 'italic'
                      }}>
                        {currentYear < 1949 
                          ? `${1950 - currentYear} year${1950 - currentYear > 1 ? 's' : ''} until resolution (October 1949)`
                          : 'Communist victory imminent - transition coming in 1950'}
                      </div>
                    </div>
                  )}

                  {/* China Communist Reconstruction Banner */}
                  {isChinaCommunist && (
                    <div style={{
                      padding: '20px',
                      background: '#fef3c7',
                      border: '2px solid #d97706',
                      borderRadius: '8px',
                      marginBottom: '30px'
                    }}>
                      <div style={{ 
                        fontWeight: 'bold', 
                        color: '#92400e', 
                        fontSize: '1.125rem',
                        marginBottom: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}>
                        üè≠ PEOPLE'S REPUBLIC OF CHINA - RECONSTRUCTION ERA
                      </div>
                      <div style={{ fontSize: '0.9rem', color: '#78350f', marginBottom: '8px' }}>
                        Communist government proclaimed October 1, 1949. Economy transitioning to planned system.
                      </div>
                      <div style={{ 
                        padding: '12px',
                        background: '#fde68a',
                        borderRadius: '6px',
                        fontSize: '0.875rem',
                        color: '#78350f'
                      }}>
                        <strong>Reconstruction Bonus:</strong> Civil war penalties removed. Centralized planning enables rapid recovery.
                      </div>
                    </div>
                  )}

                  {/* India Independence Banner */}
                  {playerCountry === 'India' && currentYear >= 1946 && currentYear < 1948 && (
                    <div style={{
                      padding: '20px',
                      background: '#fff7ed',
                      border: '2px solid #ea580c',
                      borderRadius: '8px',
                      marginBottom: '30px'
                    }}>
                      <div style={{ 
                        fontWeight: 'bold', 
                        color: '#9a3412', 
                        fontSize: '1.125rem',
                        marginBottom: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}>
                        üáÆüá≥ BRITISH RAJ - COLONIAL ADMINISTRATION
                      </div>
                      <div style={{ fontSize: '0.9rem', color: '#7c2d12', marginBottom: '8px' }}>
                        India remains under British rule. Economic policies constrained by colonial oversight.
                      </div>
                      <div style={{ 
                        padding: '12px',
                        background: '#fed7aa',
                        borderRadius: '6px',
                        fontSize: '0.875rem',
                        color: '#7c2d12',
                        marginTop: '12px'
                      }}>
                        {currentYear < 1947 
                          ? `‚è≥ Independence coming August 1947 (${1947 - currentYear + 1} year${1947 - currentYear > 0 ? 's' : ''} remaining)`
                          : 'üéâ Independence achieved August 15, 1947! Transitioning to sovereign republic...'}
                      </div>
                    </div>
                  )}

                  {/* India Post-Independence Banner */}
                  {playerCountry === 'India' && currentYear >= 1948 && (
                    <div style={{
                      padding: '20px',
                      background: '#dcfce7',
                      border: '2px solid #16a34a',
                      borderRadius: '8px',
                      marginBottom: '30px'
                    }}>
                      <div style={{ 
                        fontWeight: 'bold', 
                        color: '#166534', 
                        fontSize: '1.125rem',
                        marginBottom: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}>
                        üáÆüá≥ REPUBLIC OF INDIA - SOVEREIGN NATION
                      </div>
                      <div style={{ fontSize: '0.9rem', color: '#14532d', marginBottom: '8px' }}>
                        Independent since August 15, 1947. Building democratic institutions and modern economy.
                      </div>
                      <div style={{ 
                        padding: '12px',
                        background: '#bbf7d0',
                        borderRadius: '6px',
                        fontSize: '0.875rem',
                        color: '#14532d'
                      }}>
                        <strong>Sovereign Bonus:</strong> Full economic autonomy. Can pursue independent development strategies and non-aligned policies.
                      </div>
                    </div>
                  )}

                  {/* Policies Section Header */}

                  {/* India Colonial Period Banner (1946) */}
                  {isIndiaColonial && (
                    <div style={{
                      padding: '20px',
                      background: '#f0f9ff',
                      border: '2px solid #0284c7',
                      borderRadius: '8px',
                      marginBottom: '30px'
                    }}>
                      <div style={{ 
                        fontWeight: 'bold', 
                        color: '#075985', 
                        fontSize: '1.125rem',
                        marginBottom: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}>
                        üá¨üáß BRITISH INDIA - COLONIAL ADMINISTRATION ({currentYear})
                      </div>
                      <div style={{ fontSize: '0.9rem', color: '#0c4a6e', marginBottom: '8px' }}>
                        Still under British colonial rule. Independence negotiations ongoing. Economic policies constrained by colonial interests.
                      </div>
                      <div style={{ 
                        marginTop: '12px', 
                        fontSize: '0.875rem', 
                        color: '#0c4a6e',
                        fontStyle: 'italic'
                      }}>
                        Independence expected August 15, 1947
                      </div>
                    </div>
                  )}

                  {/* India Partition Crisis Banner (1947) */}
                  {isIndiaPartition && (
                    <div style={{
                      padding: '20px',
                      background: '#fef2f2',
                      border: '2px solid #dc2626',
                      borderRadius: '8px',
                      marginBottom: '30px'
                    }}>
                      <div style={{ 
                        fontWeight: 'bold', 
                        color: '#dc2626', 
                        fontSize: '1.125rem',
                        marginBottom: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}>
                        ‚ö†Ô∏è PARTITION OF INDIA ({currentYear})
                      </div>
                      <div style={{ fontSize: '0.9rem', color: '#7f1d1d', marginBottom: '8px' }}>
                        Independence achieved August 15, but partition into India and Pakistan triggers massive violence, displacement, and economic chaos.
                      </div>
                      <div style={{ 
                        display: 'grid', 
                        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                        gap: '8px',
                        marginTop: '12px',
                        padding: '12px',
                        background: '#fee2e2',
                        borderRadius: '6px'
                      }}>
                        <div style={{ fontSize: '0.875rem', color: '#991b1b' }}>
                          <strong>GDP:</strong> -1.5% penalty (violence, refugees)
                        </div>
                        <div style={{ fontSize: '0.875rem', color: '#991b1b' }}>
                          <strong>Inflation:</strong> +8% (supply disruption)
                        </div>
                        <div style={{ fontSize: '0.875rem', color: '#991b1b' }}>
                          <strong>Trade:</strong> -$300M (Pakistan border crisis)
                        </div>
                      </div>
                      <div style={{ 
                        marginTop: '12px', 
                        fontSize: '0.875rem', 
                        color: '#7f1d1d',
                        fontStyle: 'italic'
                      }}>
                        10-20 million displaced, 1-2 million killed. Economic recovery will take years.
                      </div>
                    </div>
                  )}

                  {/* India Post-Partition Recovery Banner (1948) */}
                  {isIndiaPostPartition && (
                    <div style={{
                      padding: '20px',
                      background: '#fff7ed',
                      border: '2px solid #f97316',
                      borderRadius: '8px',
                      marginBottom: '30px'
                    }}>
                      <div style={{ 
                        fontWeight: 'bold', 
                        color: '#c2410c', 
                        fontSize: '1.125rem',
                        marginBottom: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}>
                        üáÆüá≥ REPUBLIC OF INDIA - POST-PARTITION RECOVERY ({currentYear})
                      </div>
                      <div style={{ fontSize: '0.9rem', color: '#9a3412', marginBottom: '8px' }}>
                        First full year as independent nation. Rebuilding after partition trauma. Nehru's government focuses on stabilization and institution-building.
                      </div>
                      <div style={{ 
                        display: 'grid', 
                        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                        gap: '8px',
                        marginTop: '12px',
                        padding: '12px',
                        background: '#fed7aa',
                        borderRadius: '6px'
                      }}>
                        <div style={{ fontSize: '0.875rem', color: '#9a3412' }}>
                          <strong>GDP:</strong> -0.5% (still recovering)
                        </div>
                        <div style={{ fontSize: '0.875rem', color: '#9a3412' }}>
                          <strong>Inflation:</strong> +3% (stabilizing)
                        </div>
                        <div style={{ fontSize: '0.875rem', color: '#9a3412' }}>
                          <strong>Trade:</strong> -$100M (normalizing)
                        </div>
                      </div>
                      <div style={{ 
                        marginTop: '12px', 
                        fontSize: '0.875rem', 
                        color: '#9a3412',
                        fontStyle: 'italic'
                      }}>
                        Constitutional assembly drafting new republic. Full sovereignty by 1949.
                      </div>
                    </div>
                  )}

                  {/* India Independent Banner (1949+) */}
                  {isIndiaIndependent && (
                    <div style={{
                      padding: '20px',
                      background: '#fef3c7',
                      border: '2px solid #f59e0b',
                      borderRadius: '8px',
                      marginBottom: '30px'
                    }}>
                      <div style={{ 
                        fontWeight: 'bold', 
                        color: '#92400e', 
                        fontSize: '1.125rem',
                        marginBottom: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        gap: '8px'
                      }}>
                        üáÆüá≥ REPUBLIC OF INDIA - FULLY INDEPENDENT ({currentYear})
                      </div>
                      <div style={{ fontSize: '0.9rem', color: '#78350f', marginBottom: '8px' }}>
                        Republic proclaimed January 26, 1950. Partition crisis over. Independent foreign policy. Building democratic socialist economy.
                      </div>
                      <div style={{ 
                        padding: '12px',
                        background: '#fde68a',
                        borderRadius: '6px',
                        fontSize: '0.875rem',
                        color: '#78350f'
                      }}>
                        <strong>Full Sovereignty:</strong> No more colonial constraints or partition penalties. Chart your own economic path.
                      </div>
                    </div>
                  )}

                  {/* Military Deployment Info Panel */}
                  {gameStateData.militaryDeployments && gameStateData.militaryDeployments[playerCountry] && (
                    <details style={{
                      marginBottom: '30px',
                      padding: '16px',
                      background: '#f8fafc',
                      border: '2px solid #cbd5e1',
                      borderRadius: '8px'
                    }}>
                      <summary style={{
                        cursor: 'pointer',
                        fontWeight: 'bold',
                        fontSize: '1.125rem',
                        color: '#1e293b',
                        padding: '8px'
                      }}>
                        üó∫Ô∏è View Your Military Deployments
                      </summary>
                      <div style={{ marginTop: '16px', paddingTop: '16px', borderTop: '1px solid #e2e8f0' }}>
                        <div style={{ 
                          display: 'grid',
                          gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',
                          gap: '12px',
                          marginBottom: '16px'
                        }}>
                          <div style={{ padding: '12px', background: 'white', borderRadius: '6px' }}>
                            <div style={{ fontSize: '0.75rem', color: '#64748b', marginBottom: '4px' }}>Total Troops</div>
                            <div style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>
                              {(gameStateData.militaryDeployments[playerCountry].totalTroops / 1000000).toFixed(1)}M
                            </div>
                          </div>
                          <div style={{ padding: '12px', background: 'white', borderRadius: '6px' }}>
                            <div style={{ fontSize: '0.75rem', color: '#64748b', marginBottom: '4px' }}>Military Budget</div>
                            <div style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>
                              ${(gameStateData.militaryDeployments[playerCountry].militaryBudget / 1000).toFixed(1)}B
                            </div>
                          </div>
                          <div style={{ padding: '12px', background: 'white', borderRadius: '6px' }}>
                            <div style={{ fontSize: '0.75rem', color: '#64748b', marginBottom: '4px' }}>Deployments</div>
                            <div style={{ fontSize: '1.5rem', fontWeight: 'bold' }}>
                              {gameStateData.militaryDeployments[playerCountry].bases.length}
                            </div>
                          </div>
                        </div>
                        
                        <div style={{ fontSize: '0.875rem' }}>
                          <div style={{ fontWeight: 'bold', marginBottom: '8px', color: '#475569' }}>Deployment Locations:</div>
                          {gameStateData.militaryDeployments[playerCountry].bases.map((base, idx) => (
                            <div key={idx} style={{ 
                              padding: '8px',
                              background: 'white',
                              borderRadius: '4px',
                              marginBottom: '6px',
                              display: 'flex',
                              justifyContent: 'space-between',
                              alignItems: 'center'
                            }}>
                              <div>
                                <div style={{ fontWeight: 'bold', color: '#1e293b' }}>{base.name}</div>
                                <div style={{ fontSize: '0.75rem', color: '#64748b' }}>{base.description}</div>
                              </div>
                              <div style={{ 
                                fontSize: '0.875rem', 
                                fontWeight: 'bold',
                                color: '#3b82f6',
                                whiteSpace: 'nowrap',
                                marginLeft: '12px'
                              }}>
                                {(base.troops / 1000).toFixed(0)}K
                              </div>
                            </div>
                          ))}
                        </div>
                        
                        {gameStateData.militaryDeployments[playerCountry].notes && (
                          <div style={{ 
                            marginTop: '12px',
                            padding: '12px',
                            background: '#fef3c7',
                            borderRadius: '6px',
                            fontSize: '0.75rem',
                            color: '#92400e',
                            fontStyle: 'italic'
                          }}>
                            üìù {gameStateData.militaryDeployments[playerCountry].notes}
                          </div>
                        )}
                      </div>
                    </details>
                  )}

                  {myCountryData && (
                    <div style={{ marginBottom: '30px' }}>
                      <h3 style={{ fontSize: '1.125rem', marginBottom: '16px' }}>üìà Economic Dashboard</h3>
                      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px' }}>
                        <div style={{ padding: '16px', background: '#f0f9ff', borderRadius: '8px', border: '1px solid #bae6fd' }}>
                          <div style={{ fontSize: '0.875rem', color: '#0369a1', marginBottom: '4px' }}>GDP Growth</div>
                          <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#0c4a6e' }}>
                            {myCountryData.gdpGrowth ? myCountryData.gdpGrowth.toFixed(1) : '0.0'}%
                          </div>
                        </div>
                        <div style={{ padding: '16px', background: '#fef3c7', borderRadius: '8px', border: '1px solid #fde047' }}>
                          <div style={{ fontSize: '0.875rem', color: '#a16207', marginBottom: '4px' }}>Unemployment</div>
                          <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#78350f' }}>
                            {myCountryData.unemployment ? myCountryData.unemployment.toFixed(1) : '0.0'}%
                          </div>
                        </div>
                        <div style={{ padding: '16px', background: '#fee2e2', borderRadius: '8px', border: '1px solid #fca5a5' }}>
                          <div style={{ fontSize: '0.875rem', color: '#b91c1c', marginBottom: '4px' }}>Inflation</div>
                          <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#7f1d1d' }}>
                            {myCountryData.inflation ? myCountryData.inflation.toFixed(1) : '0.0'}%
                          </div>
                        </div>
                        <div style={{ padding: '16px', background: '#dcfce7', borderRadius: '8px', border: '1px solid #86efac' }}>
                          <div style={{ fontSize: '0.875rem', color: '#15803d', marginBottom: '4px' }}>Trade Balance</div>
                          <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#14532d' }}>
                            ${myCountryData.tradeBalance ? (myCountryData.tradeBalance / 1000).toFixed(1) : '0.0'}B
                          </div>
                        </div>
                        <div style={{ padding: '16px', background: '#fef3c7', borderRadius: '8px', border: '1px solid #fde047' }}>
                          <div style={{ fontSize: '0.875rem', color: '#a16207', marginBottom: '4px' }}>Gold Reserves</div>
                          <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#78350f' }}>
                            ${myCountryData.goldReserves ? (myCountryData.goldReserves / 1000).toFixed(1) : '0.0'}B
                          </div>
                        </div>
                        <div style={{ padding: '16px', background: '#e0e7ff', borderRadius: '8px', border: '1px solid #c7d2fe' }}>
                          <div style={{ fontSize: '0.875rem', color: '#4338ca', marginBottom: '4px' }}>Industrial Output</div>
                          <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#312e81' }}>
                            {myCountryData.industrialOutput ? myCountryData.industrialOutput.toFixed(0) : '0'}
                          </div>
                        </div>
                      </div>
                    </div>
                  )}

                  {!myPolicies ? (
                    <div style={{ marginBottom: '30px' }}>
                      <h3 style={{ fontSize: '1.125rem', marginBottom: '16px' }}>
                        ‚öôÔ∏è Set Economic Policies for {currentYear}
                      </h3>
                      <p style={{ color: '#64748b', fontSize: '0.9rem', marginBottom: '20px' }}>
                        {(playerCountry === 'USSR' || isChinaCommunist)
                          ? 'Set central planning priorities. Your command economy operates differently but still affects economic outcomes.'
                          : 'Choose your macroeconomic policies carefully. They will affect growth, unemployment, inflation, and trade.'}
                      </p>

                      <form onSubmit={submitPolicies}>
                        <div style={{ display: 'grid', gap: '24px', maxWidth: '600px', margin: '0 auto' }}>
                          
                          {/* Central Bank Rate / Credit Allocation */}
                          <div style={{ padding: '20px', background: '#f8fafc', borderRadius: '8px' }}>
                            <label style={{ display: 'block', fontWeight: 'bold', marginBottom: '12px' }}>
                              {(playerCountry === 'USSR' || isChinaCommunist)
                                ? 'üè≠ State Credit Allocation'
                                : 'üè¶ Central Bank Interest Rate'}
                            </label>
                            <p style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '12px' }}>
                              {(playerCountry === 'USSR' || isChinaCommunist)
                                ? 'Loose credit fuels production but creates shortages. Tight credit controls inflation but limits growth.'
                                : 'Lower rates stimulate growth but risk inflation. Higher rates control inflation but slow growth.'}
                            </p>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                              <input
                                type="range"
                                name="centralBankRate"
                                min="0"
                                max="10"
                                step="0.5"
                                defaultValue="3"
                                style={{ flex: 1 }}
                                onInput={(e) => e.target.nextElementSibling.textContent = e.target.value + '%'}
                              />
                              <span style={{ minWidth: '60px', fontWeight: 'bold', fontSize: '1.125rem' }}>3%</span>
                            </div>
                            <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.75rem', color: '#94a3b8', marginTop: '4px' }}>
                              {(playerCountry === 'USSR' || isChinaCommunist) ? (
                                <>
                                  <span>0% (Loose)</span>
                                  <span>5% (Balanced)</span>
                                  <span>10% (Tight)</span>
                                </>
                              ) : (
                                <>
                                  <span>0% (Loose)</span>
                                  <span>5% (Optimal)</span>
                                  <span>10% (Tight)</span>
                                </>
                              )}
                            </div>
                          </div>

                          {/* Exchange Rate / Foreign Trade Priority */}
                          <div style={{ padding: '20px', background: '#f8fafc', borderRadius: '8px' }}>
                            <label style={{ display: 'block', fontWeight: 'bold', marginBottom: '12px' }}>
                              {(playerCountry === 'USSR' || isChinaCommunist)
                                ? 'üåç Foreign Trade Priority'
                                : 'üí± Exchange Rate vs USD'}
                            </label>
                            <p style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '12px' }}>
                              {(playerCountry === 'USSR' || isChinaCommunist)
                                ? 'Export focus (low) earns hard currency. Import focus (high) acquires Western technology and goods.'
                                : 'Weak currency helps exports. Strong currency helps imports. Balance is key.'}
                            </p>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                              <input
                                type="range"
                                name="exchangeRate"
                                min="0.5"
                                max="2.0"
                                step="0.1"
                                defaultValue="1.0"
                                style={{ flex: 1 }}
                                onInput={(e) => e.target.nextElementSibling.textContent = e.target.value}
                              />
                              <span style={{ minWidth: '60px', fontWeight: 'bold', fontSize: '1.125rem' }}>1.0</span>
                            </div>
                            <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.75rem', color: '#94a3b8', marginTop: '4px' }}>
                              {(playerCountry === 'USSR' || isChinaCommunist) ? (
                                <>
                                  <span>0.5 (Export)</span>
                                  <span>1.0 (Balanced)</span>
                                  <span>2.0 (Import)</span>
                                </>
                              ) : (
                                <>
                                  <span>0.5 (Weak)</span>
                                  <span>1.0 (Parity)</span>
                                  <span>2.0 (Strong)</span>
                                </>
                              )}
                            </div>
                          </div>

                          {/* Tariff Rate / Trade Barrier Level */}
                          <div style={{ padding: '20px', background: '#f8fafc', borderRadius: '8px' }}>
                            <label style={{ display: 'block', fontWeight: 'bold', marginBottom: '12px' }}>
                              {(playerCountry === 'USSR' || isChinaCommunist)
                                ? 'üöß Trade Barrier Level'
                                : 'üì¶ Average Tariff Rate'}
                            </label>
                            <p style={{ fontSize: '0.875rem', color: '#64748b', marginBottom: '12px' }}>
                              {(playerCountry === 'USSR' || isChinaCommunist)
                                ? 'Low barriers allow Western goods and ideas. High barriers ensure autarky and ideological purity.'
                                : 'High tariffs protect domestic industry but reduce trade. Low tariffs increase efficiency.'}
                            </p>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                              <input
                                type="range"
                                name="tariffRate"
                                min="0"
                                max="50"
                                step="5"
                                defaultValue="10"
                                style={{ flex: 1 }}
                                onInput={(e) => e.target.nextElementSibling.textContent = e.target.value + '%'}
                              />
                              <span style={{ minWidth: '60px', fontWeight: 'bold', fontSize: '1.125rem' }}>10%</span>
                            </div>
                            <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '0.75rem', color: '#94a3b8', marginTop: '4px' }}>
                              {(playerCountry === 'USSR' || isChinaCommunist) ? (
                                <>
                                  <span>0% (Open)</span>
                                  <span>25% (Moderate)</span>
                                  <span>50% (Autarky)</span>
                                </>
                              ) : (
                                <>
                                  <span>0% (Free Trade)</span>
                                  <span>25% (Moderate)</span>
                                  <span>50% (Protectionist)</span>
                                </>
                              )}
                            </div>
                          </div>
                        </div>

                        <div style={{ textAlign: 'center', marginTop: '30px' }}>
                          <button type="submit" className="btn-primary" style={{ fontSize: '1.125rem', padding: '14px 32px' }}>
                            {(playerCountry === 'USSR' || isChinaCommunist)
                              ? 'üìã Submit Five-Year Plan Priorities'
                              : 'üìã Submit Economic Policies'}
                          </button>
                        </div>
                      </form>
                    </div>
                  ) : (
                    <div style={{ marginBottom: '30px' }}>
                      <div style={{ padding: '20px', background: '#dcfce7', borderRadius: '8px', marginBottom: '20px', border: '1px solid #86efac' }}>
                        <h3 style={{ fontSize: '1.125rem', color: '#15803d', marginBottom: '12px' }}>
                          ‚úÖ Your Policies Submitted for {currentYear}
                        </h3>
                        <div style={{ display: 'grid', gap: '12px' }}>
                          <div>
                            <span style={{ color: '#64748b' }}>Central Bank Rate:</span>{' '}
                            <span style={{ fontWeight: 'bold' }}>{myPolicies.centralBankRate}%</span>
                          </div>
                          <div>
                            <span style={{ color: '#64748b' }}>Exchange Rate:</span>{' '}
                            <span style={{ fontWeight: 'bold' }}>{myPolicies.exchangeRate}</span>
                          </div>
                          <div>
                            <span style={{ color: '#64748b' }}>Tariff Rate:</span>{' '}
                            <span style={{ fontWeight: 'bold' }}>{myPolicies.tariffRate}%</span>
                          </div>
                        </div>
                      </div>

                      <div style={{ textAlign: 'center' }}>
                        <p style={{ color: '#64748b', marginBottom: '16px' }}>
                          ‚è≥ Waiting for other countries to submit their policies...
                        </p>
                        <p style={{ fontSize: '0.875rem', color: '#94a3b8' }}>
                          {Object.keys(gameStateData.players).filter(pid => {
                            const player = gameStateData.players[pid];
                            return gameStateData.phase2.policies[currentYear] && gameStateData.phase2.policies[currentYear][player.country];
                          }).length} / {Object.keys(gameStateData.players).length} submitted
                        </p>

                        {allSubmitted && (
                          <button className="btn-success" onClick={advanceYear} style={{ marginTop: '20px', fontSize: '1.125rem', padding: '14px 32px' }}>
                            üìä Calculate Year Results & Continue
                          </button>
                        )}
                      </div>
                    </div>
                  )}

                  {/* Historical Data */}
                  {Object.keys(gameStateData.phase2.yearlyData).length > 1 && (
                    <div style={{ marginTop: '30px', paddingTop: '30px', borderTop: '2px solid #e2e8f0' }}>
                      <h3 style={{ fontSize: '1.125rem', marginBottom: '16px' }}>üìú Historical Performance</h3>
                      <div style={{ overflowX: 'auto' }}>
                        <table style={{ width: '100%', fontSize: '0.875rem', borderCollapse: 'collapse' }}>
                          <thead>
                            <tr style={{ background: '#f8fafc', borderBottom: '2px solid #cbd5e1' }}>
                              <th style={{ padding: '8px', textAlign: 'left' }}>Year</th>
                              <th style={{ padding: '8px', textAlign: 'right' }}>GDP</th>
                              <th style={{ padding: '8px', textAlign: 'right' }}>Unemp</th>
                              <th style={{ padding: '8px', textAlign: 'right' }}>Inflation</th>
                              <th style={{ padding: '8px', textAlign: 'right' }}>Trade</th>
                              <th style={{ padding: '8px', textAlign: 'right' }}>Gold</th>
                            </tr>
                          </thead>
                          <tbody>
                            {Object.keys(gameStateData.phase2.yearlyData).sort().map(year => {
                              const data = gameStateData.phase2.yearlyData[year][playerCountry];
                              if (!data) return null;
                              return (
                                <tr key={year} style={{ borderBottom: '1px solid #e2e8f0' }}>
                                  <td style={{ padding: '8px', fontWeight: 'bold' }}>{year}</td>
                                  <td style={{ padding: '8px', textAlign: 'right' }}>{data.gdpGrowth ? data.gdpGrowth.toFixed(1) + '%' : '-'}</td>
                                  <td style={{ padding: '8px', textAlign: 'right' }}>{data.unemployment ? data.unemployment.toFixed(1) + '%' : '-'}</td>
                                  <td style={{ padding: '8px', textAlign: 'right' }}>{data.inflation ? data.inflation.toFixed(1) + '%' : '-'}</td>
                                  <td style={{ padding: '8px', textAlign: 'right' }}>${data.tradeBalance ? (data.tradeBalance / 1000).toFixed(1) : '0.0'}B</td>
                                  <td style={{ padding: '8px', textAlign: 'right' }}>${data.goldReserves ? (data.goldReserves / 1000).toFixed(1) : '0.0'}B</td>
                                </tr>
                              );
                            })}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            );
          }

          // Game Complete
          if (gameStateData.gamePhase === 'complete') {
            const sortedScores = Object.entries(gameStateData.scores).sort((a, b) => b[1] - a[1]);
            const winner = sortedScores[0];
            const myCountry = playerCountry;
            const myRank = sortedScores.findIndex(([c]) => c === myCountry) + 1;
            const myAchievements = gameStateData.phase2?.achievements?.[myCountry];

            return (
              <div className="container">
                <UserDisplay />
                <ConnectionStatus />
                <div className="header">
                  <h1>üèÜ Game Complete - Final Results</h1>
                  <p>Bretton Woods Simulation 1944-1952</p>
                </div>

                <div className="card">
                  <div style={{ textAlign: 'center', marginBottom: '40px' }}>
                    <h2 style={{ fontSize: '2rem', marginBottom: '16px', color: '#1e293b' }}>
                      {myRank === 1 ? 'ü•á' : myRank === 2 ? 'ü•à' : myRank === 3 ? 'ü•â' : ''}
                      {' '}{countries[myCountry]?.name || myCountry || 'Unknown'}
                    </h2>
                    <div style={{ fontSize: '1.25rem', color: '#64748b', marginBottom: '8px' }}>
                      Rank: {myRank} of {sortedScores.length}
                    </div>
                    <div style={{ fontSize: '3rem', fontWeight: 'bold', color: '#16a34a' }}>
                      {gameStateData.scores[myCountry]} points
                    </div>
                  </div>

                  {/* Score Breakdown */}
                  <div style={{ marginBottom: '40px', padding: '24px', background: '#f8fafc', borderRadius: '8px' }}>
                    <h3 style={{ fontSize: '1.25rem', marginBottom: '20px', textAlign: 'center' }}>
                      üìä Your Score Breakdown
                    </h3>
                    
                    <div style={{ display: 'grid', gap: '16px', maxWidth: '500px', margin: '0 auto' }}>
                      {/* Phase 1 Score */}
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: 'white', borderRadius: '6px' }}>
                        <div>
                          <div style={{ fontWeight: 'bold' }}>Phase 1: Bretton Woods Conference</div>
                          <div style={{ fontSize: '0.875rem', color: '#64748b' }}>Negotiations (6 rounds)</div>
                        </div>
                        <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#3b82f6' }}>
                          {/* Calculate Phase 1 score (assuming Phase 2 started after round 6) */}
                          {(() => {
                            // Phase 1 score is total before Phase 2 annual scores were added
                            let phase1Score = 0;
                            if (gameStateData.phase2?.yearScores) {
                              const phase2Years = Object.keys(gameStateData.phase2.yearScores);
                              const totalPhase2 = phase2Years.reduce((sum, year) => {
                                return sum + (gameStateData.phase2.yearScores[year][myCountry]?.total || 0);
                              }, 0);
                              const achievementBonus = myAchievements?.totalBonus || 0;
                              phase1Score = gameStateData.scores[myCountry] - totalPhase2 - achievementBonus;
                            } else {
                              phase1Score = Math.floor(gameStateData.scores[myCountry] * 0.2); // Estimate
                            }
                            return phase1Score;
                          })()}
                        </div>
                      </div>

                      {/* Phase 2 Annual Scores */}
                      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: 'white', borderRadius: '6px' }}>
                        <div>
                          <div style={{ fontWeight: 'bold' }}>Phase 2: Economic Management</div>
                          <div style={{ fontSize: '0.875rem', color: '#64748b' }}>
                            Annual performance (1946-1952)
                          </div>
                        </div>
                        <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#8b5cf6' }}>
                          {(() => {
                            if (gameStateData.phase2?.yearScores) {
                              return Object.keys(gameStateData.phase2.yearScores).reduce((sum, year) => {
                                return sum + (gameStateData.phase2.yearScores[year][myCountry]?.total || 0);
                              }, 0);
                            }
                            return 0;
                          })()}
                        </div>
                      </div>

                      {/* Achievement Bonus */}
                      {myAchievements && myAchievements.totalBonus > 0 && (
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '12px', background: 'white', borderRadius: '6px', border: '2px solid #fbbf24' }}>
                          <div>
                            <div style={{ fontWeight: 'bold', color: '#d97706' }}>üèÖ Achievement Bonuses</div>
                            <div style={{ fontSize: '0.875rem', color: '#92400e' }}>
                              {myAchievements.list.length} achievement{myAchievements.list.length !== 1 ? 's' : ''} unlocked
                            </div>
                          </div>
                          <div style={{ fontSize: '1.5rem', fontWeight: 'bold', color: '#d97706' }}>
                            +{myAchievements.totalBonus}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Achievements */}
                  {myAchievements && myAchievements.list.length > 0 && (
                    <div style={{ marginBottom: '40px', padding: '24px', background: '#fef3c7', borderRadius: '8px', border: '2px solid #fbbf24' }}>
                      <h3 style={{ fontSize: '1.25rem', marginBottom: '20px', textAlign: 'center', color: '#92400e' }}>
                        üèÜ Achievements Unlocked
                      </h3>
                      <div style={{ display: 'grid', gap: '12px', maxWidth: '600px', margin: '0 auto' }}>
                        {myAchievements.list.map((achievement, idx) => (
                          <div key={idx} style={{ 
                            padding: '16px', 
                            background: 'white', 
                            borderRadius: '8px',
                            border: '2px solid #fbbf24',
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                          }}>
                            <div>
                              <div style={{ fontWeight: 'bold', fontSize: '1.125rem', color: '#92400e' }}>
                                {achievement.name}
                              </div>
                              <div style={{ fontSize: '0.875rem', color: '#78350f', marginTop: '4px' }}>
                                {achievement.description}
                              </div>
                            </div>
                            <div style={{ 
                              fontSize: '1.5rem', 
                              fontWeight: 'bold', 
                              color: '#d97706',
                              minWidth: '80px',
                              textAlign: 'right'
                            }}>
                              +{achievement.points}
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}

                  {/* Final Standings */}
                  <div style={{ marginBottom: '30px' }}>
                    <h3 style={{ fontSize: '1.25rem', marginBottom: '20px', textAlign: 'center' }}>
                      üåç Final Standings
                    </h3>
                    <div style={{ display: 'grid', gap: '12px', maxWidth: '600px', margin: '0 auto' }}>
                      {sortedScores.map(([country, score], idx) => {
                        const countryAchievements = gameStateData.phase2?.achievements?.[country];
                        const isMyCountry = country === myCountry;
                        
                        return (
                          <div key={country} style={{
                            padding: '16px',
                            background: isMyCountry ? '#dbeafe' : '#f8fafc',
                            border: isMyCountry ? '3px solid #3b82f6' : '1px solid #e2e8f0',
                            borderRadius: '8px',
                            display: 'flex',
                            justifyContent: 'space-between',
                            alignItems: 'center'
                          }}>
                            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                              <div style={{ fontSize: '1.5rem', fontWeight: 'bold', minWidth: '40px' }}>
                                {idx === 0 ? 'ü•á' : idx === 1 ? 'ü•à' : idx === 2 ? 'ü•â' : `${idx + 1}.`}
                              </div>
                              <div>
                                <div style={{ fontWeight: 'bold', fontSize: '1.125rem' }}>
                                  {countries[country]?.name || country}
                                </div>
                                {countryAchievements && countryAchievements.list.length > 0 && (
                                  <div style={{ fontSize: '0.75rem', color: '#64748b', marginTop: '2px' }}>
                                    üèÖ {countryAchievements.list.length} achievement{countryAchievements.list.length !== 1 ? 's' : ''}
                                  </div>
                                )}
                              </div>
                            </div>
                            <div style={{ fontSize: '1.75rem', fontWeight: 'bold', color: '#16a34a' }}>
                              {score}
                            </div>
                          </div>
                        );
                      })}
                    </div>
                  </div>

                  {/* Military Deployment Map */}
                  <div style={{ marginTop: '40px', marginBottom: '40px' }}>
                    <h3 style={{ fontSize: '1.5rem', marginBottom: '24px', textAlign: 'center' }}>
                      üó∫Ô∏è Global Military Deployments (1946-1952)
                    </h3>
                    
                    {/* Military Stats Cards */}
                    <div style={{ 
                      display: 'grid', 
                      gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',
                      gap: '20px',
                      marginBottom: '30px'
                    }}>
                      {Object.entries(gameStateData.militaryDeployments || {})
                        .sort((a, b) => b[1].totalTroops - a[1].totalTroops)
                        .map(([country, data]) => {
                          const countryData = countries[country];
                          if (!countryData) return null;
                          
                          return (
                            <div key={country} style={{
                              padding: '20px',
                              background: 'white',
                              border: `3px solid ${countryData.color === 'bg-blue-600' ? '#2563eb' :
                                                   countryData.color === 'bg-red-600' ? '#dc2626' :
                                                   countryData.color === 'bg-purple-600' ? '#9333ea' :
                                                   countryData.color === 'bg-amber-600' ? '#d97706' :
                                                   countryData.color === 'bg-green-600' ? '#16a34a' :
                                                   countryData.color === 'bg-orange-600' ? '#ea580c' :
                                                   countryData.color === 'bg-cyan-600' ? '#0891b2' : '#3b82f6'}`,
                              borderRadius: '12px'
                            }}>
                              <div style={{ 
                                fontSize: '1.25rem', 
                                fontWeight: 'bold', 
                                marginBottom: '12px',
                                color: '#1e293b'
                              }}>
                                {countryData.name}
                              </div>
                              
                              <div style={{ 
                                display: 'grid', 
                                gap: '8px',
                                fontSize: '0.875rem'
                              }}>
                                <div style={{ 
                                  display: 'flex', 
                                  justifyContent: 'space-between',
                                  padding: '8px',
                                  background: '#f8fafc',
                                  borderRadius: '6px'
                                }}>
                                  <span style={{ color: '#64748b' }}>üë• Total Troops:</span>
                                  <span style={{ fontWeight: 'bold' }}>
                                    {(data.totalTroops / 1000000).toFixed(1)}M
                                  </span>
                                </div>
                                
                                <div style={{ 
                                  display: 'flex', 
                                  justifyContent: 'space-between',
                                  padding: '8px',
                                  background: '#f8fafc',
                                  borderRadius: '6px'
                                }}>
                                  <span style={{ color: '#64748b' }}>üí∞ Military Budget:</span>
                                  <span style={{ fontWeight: 'bold' }}>
                                    ${(data.militaryBudget / 1000).toFixed(1)}B
                                  </span>
                                </div>
                                
                                <div style={{ 
                                  display: 'flex', 
                                  justifyContent: 'space-between',
                                  padding: '8px',
                                  background: '#f8fafc',
                                  borderRadius: '6px'
                                }}>
                                  <span style={{ color: '#64748b' }}>üéØ Deployments:</span>
                                  <span style={{ fontWeight: 'bold' }}>
                                    {data.bases.length} bases
                                  </span>
                                </div>
                              </div>
                              
                              {/* Base List */}
                              <div style={{ marginTop: '12px', paddingTop: '12px', borderTop: '1px solid #e2e8f0' }}>
                                <div style={{ fontSize: '0.75rem', fontWeight: 'bold', color: '#64748b', marginBottom: '8px' }}>
                                  MAJOR DEPLOYMENTS:
                                </div>
                                {data.bases.slice(0, 3).map((base, idx) => (
                                  <div key={idx} style={{ 
                                    fontSize: '0.75rem', 
                                    color: '#475569',
                                    marginBottom: '4px',
                                    paddingLeft: '8px'
                                  }}>
                                    ‚Ä¢ {base.name}: {(base.troops / 1000).toFixed(0)}K troops
                                  </div>
                                ))}
                              </div>
                            </div>
                          );
                        })}
                    </div>
                    
                    {/* World Map */}
                    <div style={{
                      background: 'white',
                      padding: '24px',
                      borderRadius: '12px',
                      border: '2px solid #e2e8f0'
                    }}>
                      <h4 style={{ 
                        fontSize: '1.125rem', 
                        marginBottom: '16px',
                        textAlign: 'center',
                        color: '#1e293b'
                      }}>
                        Cold War Military Presence
                      </h4>
                      
                      <div style={{ 
                        position: 'relative',
                        width: '100%',
                        paddingBottom: '50%',
                        background: '#f1f5f9',
                        borderRadius: '8px',
                        overflow: 'hidden'
                      }}>
                        <iframe 
                          src="/world-map.svg" 
                          style={{
                            position: 'absolute',
                            top: 0,
                            left: 0,
                            width: '100%',
                            height: '100%',
                            border: 'none'
                          }}
                          title="World Military Deployments"
                        />
                      </div>
                      
                      <div style={{ 
                        marginTop: '16px',
                        display: 'flex',
                        flexWrap: 'wrap',
                        gap: '16px',
                        justifyContent: 'center',
                        fontSize: '0.75rem'
                      }}>
                        {Object.entries(countries).map(([code, data]) => (
                          <div key={code} style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                            <div style={{
                              width: '16px',
                              height: '16px',
                              background: data.color === 'bg-blue-600' ? '#2563eb' :
                                         data.color === 'bg-red-600' ? '#dc2626' :
                                         data.color === 'bg-purple-600' ? '#9333ea' :
                                         data.color === 'bg-amber-600' ? '#d97706' :
                                         data.color === 'bg-green-600' ? '#16a34a' :
                                         data.color === 'bg-orange-600' ? '#ea580c' :
                                         data.color === 'bg-cyan-600' ? '#0891b2' : '#3b82f6',
                              borderRadius: '3px'
                            }} />
                            <span>{data.name}</span>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>

                  <div style={{ textAlign: 'center', marginTop: '30px' }}>
                    <button onClick={() => socket.emit('resetGame')} className="btn-primary">
                      üîÑ Play Again
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          // Voting Screen
          if (!playerCountry) {
            // Show loading if checking for resume
            if (isCheckingResume) {
              return (
                <div className="container">
                  <ConnectionStatus />
                  <div className="card">
                    <div style={{ textAlign: 'center', padding: '40px' }}>
                      <div style={{ fontSize: '3rem', marginBottom: '16px' }}>‚è≥</div>
                      <h3 style={{ color: '#1e293b', marginBottom: '12px' }}>
                        Checking for Previous Session...
                      </h3>
                      <p style={{ color: '#64748b' }}>
                        Please wait while we restore your progress
                      </p>
                    </div>
                  </div>
                </div>
              );
            }
            
            // Not in game and not checking resume
            return (
              <div className="container">
                <ConnectionStatus />
                <div className="card">
                  <h3 style={{ textAlign: 'center', color: '#dc2626', marginBottom: '20px' }}>
                    ‚ö†Ô∏è You Are Not in the Game
                  </h3>
                  <p style={{ textAlign: 'center', color: '#64748b', marginBottom: '30px' }}>
                    Please wait for the game to reset or refresh to rejoin.
                  </p>
                  <div style={{ textAlign: 'center' }}>
                    <button className="btn-secondary" onClick={() => window.location.reload()}>
                      üîÑ Refresh Page
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          const myCountry = countries[playerCountry];
          const myVoteKey = `${currentIssue.id}-${playerCountry}`;
          const myVote = gameStateData.votes[myVoteKey];
          const allVotesIn = Object.keys(gameStateData.players).every(pid => {
            const p = gameStateData.players[pid];
            const voteKey = `${currentIssue.id}-${p.country}`;
            return gameStateData.votes[voteKey] !== undefined;
          });

          return (
            <div className="container">
              <ConnectionStatus />
              <div className="header">
                <h1>üåç Bretton Woods Conference</h1>
                <p>Round {gameStateData.currentRound} of {issues.length}</p>
              </div>

              <div className="card" style={{ marginBottom: '20px' }}>
                <div style={{ display: 'flex', justifyContent: 'space-between', flexWrap: 'wrap', gap: '16px' }}>
                  <div>
                    <h3 className={myCountry.textColor} style={{ fontSize: '1.25rem', marginBottom: '4px' }}>
                      {myCountry.name}
                    </h3>
                    <p style={{ color: '#64748b', fontSize: '0.875rem' }}>
                      Score: {gameStateData.scores[playerCountry]} points
                    </p>
                  </div>
                  <div>
                    <button className="btn-secondary" onClick={() => setShowEconomics(!showEconomics)}>
                      {showEconomics ? 'Hide' : 'Show'} Economic Data
                    </button>
                  </div>
                </div>
              </div>

              {showEconomics && (
                <div className="card">
                  <h3 style={{ marginBottom: '20px' }}>Economic Position - 1944</h3>
                  <div className="economic-grid">
                    <div className="economic-card">
                      <h4>Gold Reserves</h4>
                      <p>${economicData[playerCountry].goldReserves}M</p>
                    </div>
                    <div className="economic-card">
                      <h4>GDP</h4>
                      <p>${economicData[playerCountry].gdp}M</p>
                    </div>
                    <div className="economic-card">
                      <h4>War Debt</h4>
                      <p>${economicData[playerCountry].warDebt}M</p>
                    </div>
                  </div>
                </div>
              )}

              <div className="card">
                <h2>{currentIssue.title}</h2>
                <p style={{ color: '#64748b', margin: '16px 0' }}>{currentIssue.description}</p>

                <div style={{ marginTop: '20px' }}>
                  <h3 style={{ marginBottom: '16px', fontSize: '1.125rem' }}>Options:</h3>
                  {currentIssue.options.map((option, idx) => {
                    const favorsYou = option.favors.includes(playerCountry);
                    const opposesYou = option.opposes.includes(playerCountry);
                    const isSelected = myVote === option.id;
                    
                    return (
                      <div 
                        key={option.id} 
                        onClick={() => myVote === undefined && submitVote(currentIssue.id, option.id)}
                        style={{ 
                          padding: '16px', 
                          background: isSelected ? '#3b82f6' : (favorsYou ? '#dcfce7' : opposesYou ? '#fee2e2' : '#f8fafc'),
                          borderRadius: '8px',
                          marginBottom: '12px',
                          borderLeft: '4px solid ' + (isSelected ? '#1e40af' : favorsYou ? '#16a34a' : opposesYou ? '#dc2626' : '#3b82f6'),
                          cursor: myVote === undefined ? 'pointer' : 'default',
                          transition: 'all 0.2s',
                          color: isSelected ? 'white' : 'inherit'
                        }}
                      >
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                          <div style={{ flex: 1 }}>
                            <strong style={{ fontSize: '1.125rem' }}>{String.fromCharCode(65 + idx)}.</strong> {option.text}
                          </div>
                          <div style={{ display: 'flex', gap: '8px', alignItems: 'center', marginLeft: '16px' }}>
                            {isSelected && <span style={{ fontWeight: 'bold' }}>‚úì SELECTED</span>}
                            {!isSelected && favorsYou && <span style={{ color: '#16a34a', fontSize: '0.875rem' }}>‚úì Favors (+10)</span>}
                            {!isSelected && opposesYou && <span style={{ color: '#dc2626', fontSize: '0.875rem' }}>‚úó Opposes (-5)</span>}
                          </div>
                        </div>
                      </div>
                    );
                  })}
                </div>

                <div style={{ marginTop: '30px', padding: '20px', background: '#f8fafc', borderRadius: '8px', textAlign: 'center' }}>
                  {myVote === undefined ? (
                    <p style={{ color: '#64748b' }}>
                      üëÜ Click on an option above to cast your vote
                    </p>
                  ) : (
                    <div>
                      <p style={{ fontSize: '1.125rem', color: '#16a34a', fontWeight: 'bold', marginBottom: '12px' }}>
                        ‚úì Vote Cast for Option {String.fromCharCode(65 + currentIssue.options.findIndex(o => o.id === myVote))}
                      </p>
                      <button className="btn-secondary" onClick={() => submitVote(currentIssue.id, undefined)}>
                        Change Vote
                      </button>
                    </div>
                  )}
                </div>

                {myVote !== undefined && !allVotesIn && (
                  <div style={{ marginTop: '20px', padding: '16px', background: '#fef3c7', borderRadius: '8px', textAlign: 'center' }}>
                    <p style={{ color: '#92400e' }}>
                      ‚è≥ Waiting for other players... ({Object.keys(gameStateData.players).filter(id => {
                        const p = gameStateData.players[id];
                        const vk = `${currentIssue.id}-${p.country}`;
                        return gameStateData.votes[vk] !== undefined;
                      }).length} / {Object.keys(gameStateData.players).length} voted)
                    </p>
                  </div>
                )}

                {allVotesIn && (
                  <div style={{ marginTop: '20px' }}>
                    <div style={{ marginBottom: '16px', padding: '16px', background: '#dcfce7', borderRadius: '8px' }}>
                      <p style={{ color: '#166534', textAlign: 'center', fontWeight: 'bold', marginBottom: '12px' }}>
                        ‚úì All players voted!
                      </p>
                      {(() => {
                        const voteCounts = {};
                        currentIssue.options.forEach(opt => voteCounts[opt.id] = 0);
                        
                        Object.keys(gameStateData.players).forEach(pid => {
                          const p = gameStateData.players[pid];
                          const vk = `${currentIssue.id}-${p.country}`;
                          const vote = gameStateData.votes[vk];
                          if (vote) voteCounts[vote]++;
                        });
                        
                        let winningId = null;
                        let maxVotes = -1;
                        Object.entries(voteCounts).forEach(([optId, count]) => {
                          if (count > maxVotes) {
                            maxVotes = count;
                            winningId = optId;
                          }
                        });
                        
                        const winningOption = currentIssue.options.find(o => o.id === winningId);
                        
                        return (
                          <div style={{ marginTop: '12px' }}>
                            <p style={{ color: '#166534', fontSize: '0.875rem', textAlign: 'center' }}>
                              <strong>Vote Results:</strong>
                            </p>
                            {currentIssue.options.map((opt, idx) => (
                              <p key={opt.id} style={{ 
                                color: opt.id === winningId ? '#166534' : '#64748b',
                                fontSize: '0.875rem',
                                textAlign: 'center',
                                fontWeight: opt.id === winningId ? 'bold' : 'normal'
                              }}>
                                {opt.id === winningId ? 'üèÜ ' : ''}
                                Option {String.fromCharCode(65 + idx)}: {voteCounts[opt.id]} vote{voteCounts[opt.id] !== 1 ? 's' : ''}
                                {opt.id === winningId ? ' - WINNER!' : ''}
                              </p>
                            ))}
                            {winningOption && (
                              <div style={{ marginTop: '12px', padding: '12px', background: '#f0fdf4', borderRadius: '6px' }}>
                                <p style={{ fontSize: '0.875rem', color: '#166534' }}>
                                  <strong>Adopted Policy:</strong> {winningOption.text}
                                </p>
                              </div>
                            )}
                          </div>
                        );
                      })()}
                    </div>
                    
                    <div style={{ textAlign: 'center' }}>
                      <button className={isReady ? 'btn-success' : 'btn-primary'} onClick={toggleReady} style={{ marginRight: '12px' }}>
                        {isReady ? '‚úì Ready' : 'Mark Ready'}
                      </button>
                      
                      {gameStateData.readyPlayers.length === Object.keys(gameStateData.players).length && (
                        <button className="btn-success" onClick={advanceRound}>
                          {gameStateData.currentRound < issues.length ? 'Next Round ‚Üí' : 'See Results'}
                        </button>
                      )}
                    </div>
                    
                    <p style={{ textAlign: 'center', marginTop: '12px', fontSize: '0.875rem', color: '#64748b' }}>
                      {gameStateData.readyPlayers.length} / {Object.keys(gameStateData.players).length} ready
                    </p>
                  </div>
                )}
              </div>
            </div>
          );
        };

        function initializeApp() {
          ReactDOM.render(<BrettonWoodsMultiplayer />, document.getElementById('root'));
        }
    </script>
</body>
</html>
